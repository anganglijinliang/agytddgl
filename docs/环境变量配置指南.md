# 环境变量配置指南

## 简介

本文档提供关于如何正确配置应用程序环境变量的指南，以确保应用在本地开发环境和Vercel生产环境中都能正常运行。

## 必要的环境变量

以下环境变量对应用程序的运行至关重要：

| 环境变量 | 描述 | 示例 |
|---------|------|------|
| `DATABASE_URL` | PostgreSQL数据库连接URL | `postgresql://user:password@host:port/dbname?sslmode=require` |
| `NEXTAUTH_SECRET` | NextAuth加密密钥 | 随机字符串，如`your-secret-key` |
| `NEXTAUTH_URL` | 应用部署的URL | 开发环境：`http://localhost:3000`<br>生产环境：`https://yourdomain.com` |
| `POSTGRES_URL` | Postgres连接URL (Vercel) | `postgres://user:password@host:port/dbname` |
| `POSTGRES_PRISMA_URL` | Prisma用于连接的URL | `postgres://user:password@host:port/dbname` |
| `POSTGRES_URL_NON_POOLING` | 非连接池模式URL | `postgres://user:password@host:port/dbname` |
| `POSTGRES_USER` | 数据库用户名 | `postgres` |
| `POSTGRES_PASSWORD` | 数据库密码 | `your-password` |
| `POSTGRES_DATABASE` | 数据库名 | `postgres` |
| `POSTGRES_HOST` | 数据库主机 | `db.example.com` |

## 本地开发环境配置

1. 在项目根目录创建`.env.local`文件
2. 填入上述所有必要的环境变量
3. 确保不要将此文件提交到版本控制系统

示例`.env.local`文件:

```
DATABASE_URL=postgresql://postgres:password@localhost:5432/mydatabase
NEXTAUTH_SECRET=your-development-secret-key
NEXTAUTH_URL=http://localhost:3000
# 其他环境变量...
```

## Vercel生产环境配置

在Vercel部署项目时，需要在Vercel仪表板中配置环境变量：

1. 进入Vercel项目仪表板
2. 点击"Settings" > "Environment Variables"
3. 添加上述所有必要的环境变量
4. 保存并重新部署应用

注意：生产环境的`NEXTAUTH_URL`应设置为实际部署的URL，例如`https://yourdomain.vercel.app`。

## 问题排查

如果遇到以下问题，可能与环境变量配置有关：

1. **数据库连接失败** - 检查`DATABASE_URL`是否正确
2. **身份验证失败** - 检查`NEXTAUTH_SECRET`和`NEXTAUTH_URL`
3. **Prisma查询失败** - 检查所有数据库相关环境变量

## 安全注意事项

- 不要在代码中硬编码敏感信息
- 不要将包含敏感信息的`.env`文件提交到Git
- 定期更新密码和密钥
- 使用最小权限原则配置数据库用户 